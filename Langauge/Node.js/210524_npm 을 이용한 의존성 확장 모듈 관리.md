# NPM 을 이용한 의존성 확장 모듈 관리

- [NPM 을 이용한 의존성 확장 모듈 관리](#npm-을-이용한-의존성-확장-모듈-관리)
  - [npm 소개](#npm-소개)
  - [npm 사용법](#npm-사용법)
  - [npm 을 이용한 확장 모듈 설치](#npm-을-이용한-확장-모듈-설치)
    - [글로벌 설치](#글로벌-설치)
    - [로컬 설치](#로컬-설치)
  - [확장모듈 검색](#확장모듈-검색)
  - [설치된 확장 모듈 관리](#설치된-확장-모듈-관리)
  - [package.json 을 이용한 프로젝트 관리](#packagejson-을-이용한-프로젝트-관리)
    - [name](#name)
    - [version](#version)
    - [description](#description)
    - [keywords](#keywords)
    - [hompage](#hompage)
    - [author](#author)
    - [contributors](#contributors)
    - [repository](#repository)
    - [scripts](#scripts)
    - [config](#config)
    - [private](#private)
    - [dependencies](#dependencies)
    - [devDependencies](#devdependencies)
    - [engine](#engine)
    - [package.json 자동 생성](#packagejson-자동-생성)
  - [정리](#정리)

기본 모듈만 사용하여 직접 작성할 수도 있지만, 다른 개발자들이 미리 만들어둔 수많은 확장 모듈들을 사용하면 필요한 기능을 훨씬 빠르게 개발할 수 있습니다.

## npm 소개

npm 은 노드를 위한 패키지 매니저입니다. 많은 개발자들이 확장 모듈을 만들고, 이 확장 모듈을 쉽게 관리해주는것이 npm 입니다.  이미 존재하는 모듈을 이용하면 생산성을 높일 수 있습니다.

서버에 배포하거나 협업하는 개발자가 개발 환경을 설정할 때 **소스가 의존하는 확장 모듈도 함께 설치**되어야 합니다. 확장 모듈은 새로 추가되거나/버전이 바뀌는 경우도 많으므로 모듈에 대한 관리가 필요하고, 이것을 npm 이 관리해줍니다.

npm 은 모든 사용자가 접근할 수 있는 [중앙저장소](https://www.npmjs.com/)를 제공하고 각 노드 개발자가 자신이 만든 모듈을 패키징해 npm 에 배포합니다. 또한 `package.json` 파일에 **프로젝트 관련 정보**와 **의존성 확장 모듈에 대한 정보**도 담고있으므로, `package.json` 만 공유하면 각 개발자가 자신의 로컬 환경에서 필요한 의존 모듈을 설치할 수 있습니다. 버전을 변경할 때도 `package.json` 만 수정하여 공유하면 됩니다.

## npm 사용법

파라미터 없이 `npm` 만 입력하면 사용할 수 있는 명령어 리스트들을 볼 수 있습니다.


``` bash
    $ npm

    Usage: npm <command>

    where <command> is one of:
        access, adduser, audit, bin, bugs, c, cache, ci, cit,
        clean-install, clean-install-test, completion, config,
        create, ddp, dedupe, deprecate, dist-tag, docs, doctor,
        edit, explore, fund, get, help, help-search, hook, i, init,
        install, install-ci-test, install-test, it, link, list, ln,
        login, logout, ls, org, outdated, owner, pack, ping, prefix,
        profile, prune, publish, rb, rebuild, repo, restart, root,
        run, run-script, s, se, search, set, shrinkwrap, star,
        stars, start, stop, t, team, test, token, tst, un,
        uninstall, unpublish, unstar, up, update, v, version, view,
        whoami

    npm <command> -h  quick help on <command>
    npm -l            display full usage info
    npm help <term>   search for help on <term>
    npm help npm      involved overview

    Specify configs in the ini-formatted file:
        C:\Users\user\.npmrc
    or on the command line via: npm <command> --key value
    Config info can be viewed via: npm help config

    npm@6.14.12 C:\Program Files\nodejs\node_modules\npm
```

## npm 을 이용한 확장 모듈 설치

npm 의 확장 모듈은 *글로벌 설치*, *로컬 설치*로 나뉩니다.

* **글로벌 설치** 
  * 커맨드라인에서 명령어로 사용할 경우
  * `/usr/local/lib` 하위의 `node_modules` 디렉토리 아래에 설치됩니다.
  * npm 설치 경로에 따라 달라질 수 있습니다.
  
* **로컬 설치**
  * 소스에서 `require('module_name')` 으로 접근할 경우
  * 현재 위치 기준으로 `node_modules` 디렉토리에 설치됩니다.

(직접 만든 모듈을 중앙저장소에 배포하거나 중앙저장소를 복사해 개인 npm 저장소를 만들 수도 있지만, 생략합니다.)

### 글로벌 설치

커맨드라인에서 사용하는 모듈은 **노드로 작성한 소스와는 의존성을 갖지않는 도구**로, 개발단계의 편의성 등을 위해 사용합니다. 

``` bash
    # $ npm install nodemon -g
    $ npm install <module_name> -g

    $ npm list -g    # 글로벌에 설치된 모듈 리스트 확인
    # $ npm ls -g    # 자세한 정보로 리스트 출력
    # $ npm ll -g    
    # $ npm la -g
```

글로벌로 설치할 경우, 아래처럼 커맨드라인에서 사용 가능합니다. (예제이므로 동작하지않습니다.)

``` bash
    $ nodemon ./server.js localhost 8080
```

### 로컬 설치

로컬 설치는 소스에서 사용해야하는 확장 모듈일 경우 사용합니다. 로컬에 설치되는 확장 모듈은 앱 소스코드와 연결되어 있기 때문에 **애플리케이션과 함께 관리**되어야 합니다.

확장 모듈을 설치하려면 특정 모듈 (`<module_name>`) 을 로컬에 설치합니다. 작성하는 애플리케이션의 루트 디렉토리(`package.json` 이 존재하는 디렉토리) 에서 다음과 같이 설치를 진행합니다.

``` bash
  # $ npm install reqeust
  $ npm install <module_name>
  $ npm install <module_name> <module_name> <module_name> ...  # 다중설치

  $ npm list    # 로컬에 설치된 모듈 리스트 확인
```

설치된 모듈은 `module-name@1.0.0` 형식으로, *모듈명@버전* 형식으로 루트 디렉토리와 함께 출력됩니다. 로컬에 설치된 모듈은 프로젝트의 루트 디렉토리의 `node_modules` 디렉토리가 생성되며, 그 아래에 설치됩니다.

모듈중에는 글로벌/로컬 설치가 둘 다 필요한 경우도 있습니다. 소스에서도 사용하지만, 커맨드라인에서 편의 기능을 제공하는 경우도 있습니다. 이런 모듈은 글로벌 설치와 로컬 설치를 따로 해주는 것이 좋습니다.

## 확장모듈 검색

npm 공식 사이트에서 직접 검색할 수도 있지만, 커맨드 라인에서 명령어로 검색할수도 있습니다.

``` bash
  # $ npm search twitter    # twitter 와 관련된 모듈 찾기
  $ npm search <module_name>
```

<img src="./images/210524_npmsearch_twitter.JPG" width=600 />

검색 속도를 높이기 위해 최초 실행시 확장 모듈에 대한 인덱스를 로컬에 저장하기 때문에, 초반에는 느릴 수 있습니다. 필요한 모듈을 찾았으면 모듈의 자세한 정보를 확인할 수 있습니다.

``` bash
  # $ npm info twitter-stream-channels
  $ npm info <module_name>
```
<img src="./images/210524_npmsearch_info.JPG" width=600 />

## 설치된 확장 모듈 관리

모듈을 설치한 후 최신 버전에 대한 업데이트나 필요없는 모듈 삭제 등의 관리가 필요합니다.

1. **모듈 업데이트**
  
``` bash
  $ npm update <module_name>
```

2. **모듈 버전 지정 업데이트** 

``` bash
  # $ npm install request@2.9.0
  $ npm install <module_name>@<version>
```

3. **모듈의 이전 버전 확인**

``` bash
  $ npm info <module_name>
```

4. **설치된 모듈 삭제**

``` bash
  $ npm uninstall <module_name>
```

`uninstall` 대신 `node_modules` 에 있는 모듈의 디렉토리를 삭제해도 같습니다.

## package.json 을 이용한 프로젝트 관리

### name

### version

### description

### keywords

### hompage

### author

### contributors

### repository

### scripts

### config

### private

### dependencies

### devDependencies

### engine

### package.json 자동 생성

## 정리

// ====


** 익스프레스 예제만 해보기

** socket.io 

** soket io & express chat - 예제 클론코딩

** 디버깅 정리
